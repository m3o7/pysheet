<link rel="import" href="/static/js/bower_components/polymer/polymer.html">
<link rel="import" href="/static/js/bower_components/polymer-ajax/polymer-ajax.html">

<polymer-element name="pys-project" attributes="name projects showTables tables">
    
    <template>
        <style type="text/css">
            button {
                background-color:   #FFFFFF;
                border:             none;
                color:              #26AFD8;
                font-size:          20px;
                height:             50px;
                outline:            none !important;
                padding:            0;
                width:              100%;
                font-family:        arial;
            }
            button:hover {
                background-color:   #26AFD8;
                border:             1px solid #FFFFFF;
                color:              #FFFFFF;
            }
            .table-box {
                margin: auto;
                min-width:  300px;
                width:      25%;
            }
            .end {
                background-color: rgba(255,255,255,0.5);
                margin-bottom: 10px;
                color: #FFFFFF;
            }
        </style>

        <button on-click="{{openProject}}">{{name}}</button>

        <!-- to load the tables -->
        <polymer-ajax id="tables" url="/project/{{name}}" response="{{tables}}" handleAs="json">
        <template if="{{ showTables }}">
            <div class="table-box">
                <template repeat="{{ table in tables }}">
                    <button class="table" on-click="{{openTable}}" id="{{ table }}">{{ table }}</button>
                </template>
                <button class="table end" on-click="{{getNewTableName}}">+</button>
            </div>
        </template>

    </template>

    <script>
        Polymer('pys-project', {
            showTables: false,
            tables: [],

            openProject: function(event, detail, sender){
                // get the tables
                this.showTables = !this.showTables;
                if (this.showTables) {
                    console.debug('opening project ' + this.name);
                    this.$.tables.go();
                };
            },

            openTable: function(event, detail, sender){
                var tableName = event.target.getAttribute('id');
                console.debug('open table: ' + tableName);
                this.fire('open-table', {name: tableName, project: this.name});
            },

            getNewTableName: function(event, detail, sender){
                console.debug('getting new table name');
            },
        });
    </script>

</polymer-element>